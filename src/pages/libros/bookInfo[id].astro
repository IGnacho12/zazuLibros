---
import Header from "../../components/Header.astro";
import ButtonInfoBook from "../../components/ButtonInfoBook.astro";
export const prerender = false;
import Layout from "../../layouts/Layout.astro";

const { id } = Astro.params;

// Traer los libros de la API
const res = await fetch("http://localhost:4321/api/getBooks");
const libros = await res.json();

// Buscar libro por id
const libro = libros.find((l) => String(l.id) === id);
---

<Layout>
  <Header></Header>
  <!-- DIV para mover el contenido de la pagina tapado por el header -->
  <div class=" mb-16"></div>
  {libro ? (
    <article class="max-w-5xl mx-auto p-6 flex flex-col md:flex-row gap-8">
      
      <!-- Portada -->
      <div class="flex-shrink-0 max-w-1/2 min-1/2 aspect-2/3">
        <img 
          src={libro.portada_url} 
          alt={`Portada de ${libro.nombre}`} 
          class="w-full rounded shadow-md"
        />
      </div>

      <!-- InformaciÃ³n -->
      <div class="flex-1 flex flex-col gap-4">
        <!-- TÃ­tulo y autor -->
        <div>
          <h1 class="text-3xl font-bold text-[var(--text)]">{libro.nombre}</h1>
          <p class="text-gray-600 dark:text-gray-300 italic">Autor: {libro.autor}</p>
        </div>

        <!-- Texto descriptivo / reseÃ±as -->
        <div class="space-y-2">
          <h2 class="text-xl font-semibold">DescripciÃ³n</h2>
          <p class="text-gray-700 dark:text-gray-300">
            {libro.descripcion}
          </p>

          {/* <h2 class="text-xl font-semibold mt-4">Comentarios</h2>
          <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 space-y-1">
            <li>â€œExcelente libro para principiantesâ€</li>
            <li>â€œMuy informativo y fÃ¡cil de leerâ€</li>
            <li>â€œLo recomiendo a todos los amantes de la lecturaâ€</li>
          </ul>
        </div> */}

        <!-- Botones de acciÃ³n -->
        <div class="mt-6 flex flex-wrap gap-4">
          <ButtonInfoBook url=`${libro.archivo_url}``>Descargar <svg data-testid="geist-icon" height="16" stroke-linejoin="round" style="color:currentColor" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75ZM13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z" fill="currentColor"></path></svg></ButtonInfoBook>
          <ButtonInfoBook>Vista desde el navegador</ButtonInfoBook>
        </div>

        <!-- Texto informativo arriba de PDFEmbed -->
        <p class="mt-4 text-sm text-gray-500 dark:text-gray-400">
          La vista con PDFEmbed ofrece mÃ¡s funcionalidades que la visualizaciÃ³n estÃ¡ndar del navegador.
        </p>
      </div>
    </article>
  ) : (
    <h1 class="text-center text-xl mt-20">ğŸ“• Libro no encontrado</h1>
  )}
  
</Layout>
